"use strict";(self.webpackChunkbeznet_miniapp=self.webpackChunkbeznet_miniapp||[]).push([[330],{330(t,e,s){function n(t,e){if(null==t)return{};var s,n,r=function(t,e){if(null==t)return{};var s={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(-1!==e.indexOf(n))continue;s[n]=t[n]}return s}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;n<i.length;n++)s=i[n],-1===e.indexOf(s)&&{}.propertyIsEnumerable.call(t,s)&&(r[s]=t[s])}return r}s.r(e),s.d(e,{BackButton:()=>qt,BasicNavigator:()=>hs,BiometryManager:()=>ae,BrowserNavigator:()=>gs,ClosingBehavior:()=>ue,CloudStorage:()=>me,ERR_INVALID_PATH_BASE:()=>W,ERR_INVOKE_CUSTOM_METHOD_RESPONSE:()=>O,ERR_METHOD_PARAMETER_UNSUPPORTED:()=>I,ERR_METHOD_UNSUPPORTED:()=>R,ERR_NAVIGATION_HISTORY_EMPTY:()=>V,ERR_NAVIGATION_INDEX_INVALID:()=>M,ERR_NAVIGATION_ITEM_INVALID:()=>L,ERR_PARSE:()=>D,ERR_SSR_INIT:()=>B,ERR_TIMED_OUT:()=>q,ERR_UNEXPECTED_TYPE:()=>N,ERR_UNKNOWN_ENV:()=>k,EventEmitter:()=>P,HapticFeedback:()=>ve,InitData:()=>Ee,Invoice:()=>xe,MainButton:()=>Se,MiniApp:()=>ke,Popup:()=>Ne,QRScanner:()=>Ve,SDKError:()=>S,SettingsButton:()=>Le,ThemeParams:()=>Ue,Utils:()=>Je,Viewport:()=>Qe,array:()=>fe,bindMiniAppCSSVars:()=>Xe,bindThemeParamsCSSVars:()=>ts,bindViewportCSSVars:()=>es,boolean:()=>j,captureSameReq:()=>mt,classNames:()=>At,compareVersions:()=>at,createBrowserNavigatorFromLocation:()=>fs,createPostEvent:()=>bt,createSafeURL:()=>ze,date:()=>Nt,getHash:()=>bs,getPathname:()=>_s,initBackButton:()=>re,initBiometryManager:()=>he,initClosingBehavior:()=>le,initCloudStorage:()=>we,initHapticFeedback:()=>ye,initInitData:()=>Ae,initInvoice:()=>Ce,initMainButton:()=>Te,initMiniApp:()=>Oe,initNavigator:()=>ms,initPopup:()=>De,initQRScanner:()=>Me,initSettingsButton:()=>Be,initThemeParams:()=>He,initUtils:()=>Ke,initViewport:()=>Ye,initWeb:()=>ss,invokeCustomMethod:()=>Et,isColorDark:()=>Tt,isIframe:()=>lt,isPageReload:()=>ee,isRGB:()=>xt,isRGBShort:()=>Ct,isSDKError:()=>os,isSDKErrorOfType:()=>as,isSSR:()=>ns,isTMA:()=>rs,json:()=>K,mergeClassNames:()=>Pt,mockTelegramEnv:()=>is,number:()=>$,off:()=>rt,on:()=>it,parseInitData:()=>Pe,parseLaunchParams:()=>Ht,parseThemeParams:()=>We,postEvent:()=>ft,request:()=>yt,requestBiometryInfo:()=>ce,requestThemeParams:()=>Ge,requestViewport:()=>$e,retrieveLaunchParams:()=>te,rgb:()=>Bt,searchParams:()=>Dt,serializeLaunchParams:()=>Zt,serializeThemeParams:()=>Yt,setCSSVar:()=>Ze,setDebug:()=>A,setTargetOrigin:()=>_t,string:()=>F,subscribe:()=>w,supports:()=>ht,targetOrigin:()=>gt,toRGB:()=>St,unsubscribe:()=>m,urlToPath:()=>us,withTimeout:()=>vt});var r=s(555);const i=["postEvent","version"],o=["reason"],a=["reason"],c=["token"],h=["postEvent"],p=["postEvent","createRequestId","version","botInline"],u=["themeParams","botInline","state"],l=["is_expanded","is_state_stable"],d=["isStateStable"],_=["params"];var g=Object.defineProperty,f=(t,e,s)=>((t,e,s)=>e in t?g(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s)(t,"symbol"!=typeof e?e+"":e,s);function b(t,e){let s;const n=()=>{void 0!==s&&e&&e(s),s=void 0};return[()=>void 0===s?s=t(n):s,n]}function m(t){const e=nt(),{count:s}=e;e.unsubscribe(t),s&&!e.count&&st()}function w(t){return nt().subscribe(t),()=>m(t)}const v=new class{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.scope=t,this.options=e}print(t){const e=new Date,s=Intl.DateTimeFormat("en-GB",{hour:"2-digit",minute:"2-digit",second:"2-digit",fractionalSecondDigits:3,timeZone:"UTC"}).format(e),{textColor:n,bgColor:r}=this.options,i="font-weight: bold;padding: 0 5px;border-radius:5px";for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];console[t]("%c".concat(s,"%c / %c").concat(this.scope),"".concat(i,";background-color: lightblue;color:black"),"","".concat(i,";").concat(n?"color:".concat(n,";"):"").concat(r?"background-color:".concat(r):""),...a)}error(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.print("error",...e)}log(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];this.print("log",...e)}}("SDK",{bgColor:"forestgreen",textColor:"white"});let y=!1;const E=t=>{let{name:e,payload:s}=t;v.log("Event received:",s?{name:e,payload:s}:{name:e})};function A(t){y!==t&&(y=t,t?w(E):m(E))}class P{constructor(){f(this,"listeners",new Map),f(this,"listenersCount",0),f(this,"subscribeListeners",[])}clear(){this.listeners.clear(),this.subscribeListeners=[]}get count(){return this.listenersCount+this.subscribeListeners.length}emit(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),n=1;n<e;n++)s[n-1]=arguments[n];this.subscribeListeners.forEach(e=>e({event:t,args:s})),(this.listeners.get(t)||[]).forEach(e=>{let[n,r]=e;n(...s),r&&this.off(t,n)})}on(t,e,s){let n=this.listeners.get(t);return n||this.listeners.set(t,n=[]),n.push([e,s]),this.listenersCount+=1,()=>this.off(t,e)}off(t,e){const s=this.listeners.get(t)||[];for(let n=0;n<s.length;n+=1)if(e===s[n][0])return s.splice(n,1),void(this.listenersCount-=1)}subscribe(t){return this.subscribeListeners.push(t),()=>this.unsubscribe(t)}unsubscribe(t){for(let e=0;e<this.subscribeListeners.length;e+=1)if(this.subscribeListeners[e]===t)return void this.subscribeListeners.splice(e,1)}}function x(t,e,s){return window.addEventListener(t,e,s),()=>window.removeEventListener(t,e,s)}function C(){let t=!1;for(var e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];const r=s.flat(1);return[e=>!t&&r.push(e),()=>{t||(t=!0,r.forEach(t=>t()))},t]}class S extends Error{constructor(t,e,s){super(e,{cause:s}),this.type=t,Object.setPrototypeOf(this,S.prototype)}}function T(t,e,s){return new S(t,e,s)}const R="ERR_METHOD_UNSUPPORTED",I="ERR_METHOD_PARAMETER_UNSUPPORTED",k="ERR_UNKNOWN_ENV",O="ERR_INVOKE_CUSTOM_METHOD_RESPONSE",q="ERR_TIMED_OUT",N="ERR_UNEXPECTED_TYPE",D="ERR_PARSE",V="ERR_NAVIGATION_LIST_EMPTY",M="ERR_NAVIGATION_CURSOR_INVALID",L="ERR_NAVIGATION_ITEM_INVALID",B="ERR_SSR_INIT",W="ERR_INVALID_PATH_BASE";function U(){return T(N,"Value has unexpected type")}class H{constructor(t,e,s){this.parser=t,this.isOptional=e,this.type=s}parse(t){if(!this.isOptional||void 0!==t)try{return this.parser(t)}catch(e){throw T(D,"Unable to parse value".concat(this.type?" as ".concat(this.type):""),e)}}optional(){return this.isOptional=!0,this}}function G(t,e){return()=>new H(t,!1,e)}const j=G(t=>{if("boolean"==typeof t)return t;const e=String(t);if("1"===e||"true"===e)return!0;if("0"===e||"false"===e)return!1;throw U()},"boolean");function z(t,e){const s={};for(const r in t){const i=t[r];if(!i)continue;let o,a;if("function"==typeof i||"parse"in i)o=r,a="function"==typeof i?i:i.parse.bind(i);else{const{type:t}=i;o=i.from||r,a="function"==typeof t?t:t.parse.bind(t)}try{const t=a(e(o));void 0!==t&&(s[r]=t)}catch(n){throw T(D,'Unable to parse field "'.concat(r,'"'),n)}}return s}function J(t){let e=t;if("string"==typeof e&&(e=JSON.parse(e)),"object"!=typeof e||null===e||Array.isArray(e))throw U();return e}function K(t,e){return new H(e=>{const s=J(e);return z(t,t=>s[t])},!1,e)}const $=G(t=>{if("number"==typeof t)return t;if("string"==typeof t){const e=Number(t);if(!Number.isNaN(e))return e}throw U()},"number"),F=G(t=>{if("string"==typeof t||"number"==typeof t)return t.toString();throw U()},"string");function Q(t){return K({eventType:F(),eventData:t=>t}).parse(t)}function Y(){["TelegramGameProxy_receiveEvent","TelegramGameProxy","Telegram"].forEach(t=>{delete window[t]})}function Z(t,e){window.dispatchEvent(new MessageEvent("message",{data:JSON.stringify({eventType:t,eventData:e}),source:window.parent}))}const X={clipboard_text_received:K({req_id:F(),data:t=>null===t?t:F().optional().parse(t)}),custom_method_invoked:K({req_id:F(),result:t=>t,error:F().optional()}),popup_closed:{parse:t=>K({button_id:t=>null==t?void 0:F().parse(t)}).parse(null!==t&&void 0!==t?t:{})},viewport_changed:K({height:$(),width:t=>null==t?window.innerWidth:$().parse(t),is_state_stable:j(),is_expanded:j()})};function tt(){const t=new P,e=new P;e.subscribe(e=>{t.emit("event",{name:e.event,payload:e.args[0]})}),[["TelegramGameProxy_receiveEvent"],["TelegramGameProxy","receiveEvent"],["Telegram","WebView","receiveEvent"]].forEach(t=>{let e=window;t.forEach((t,s,n)=>{s!==n.length-1?(t in e||(e[t]={}),e=e[t]):e[t]=Z})});const[,s]=C(Y,x("resize",()=>{e.emit("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})}),x("message",t=>{if(t.source!==window.parent)return;let s;try{s=Q(t.data)}catch(o){return}const{eventType:n,eventData:r}=s,i=X[n];try{const t=i?i.parse(r):r;e.emit(...t?[n,t]:[n])}catch(a){v.error('An error occurred processing the "'.concat(n,'" event from the Telegram application.\nPlease, file an issue here:\nhttps://github.com/Telegram-Mini-Apps/tma.js/issues/new/choose'),s,a)}}),()=>t.clear(),()=>e.clear());return[{on:e.on.bind(e),off:e.off.bind(e),subscribe:e=>t.on("event",e),unsubscribe(e){t.off("event",e)},get count(){return e.count+t.count}},s]}const[et,st]=b(t=>{const[e,s]=tt(),n=e.off.bind(e);return e.off=(s,r)=>{const{count:i}=e;n(s,r),i&&!e.count&&t()},[e,s]},t=>{let[,e]=t;return e()});function nt(){return et()[0]}function rt(t,e){nt().off(t,e)}function it(t,e,s){return nt().on(t,e,s)}function ot(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function at(t,e){const s=t.split("."),n=e.split("."),r=Math.max(s.length,n.length);for(let i=0;i<r;i+=1){const t=parseInt(s[i]||"0",10),e=parseInt(n[i]||"0",10);if(t!==e)return t>e?1:-1}return 0}function ct(t,e){return at(t,e)<=0}function ht(t,e,s){if("string"==typeof s){if("web_app_open_link"===t){if("try_instant_view"===e)return ct("6.4",s);if("try_browser"===e)return ct("7.6",s)}if("web_app_set_header_color"===t&&"color"===e)return ct("6.9",s);if("web_app_close"===t&&"return_back"===e)return ct("7.6",s)}switch(t){case"web_app_open_tg_link":case"web_app_open_invoice":case"web_app_setup_back_button":case"web_app_set_background_color":case"web_app_set_header_color":case"web_app_trigger_haptic_feedback":return ct("6.1",e);case"web_app_open_popup":return ct("6.2",e);case"web_app_close_scan_qr_popup":case"web_app_open_scan_qr_popup":case"web_app_read_text_from_clipboard":return ct("6.4",e);case"web_app_switch_inline_query":return ct("6.7",e);case"web_app_invoke_custom_method":case"web_app_request_write_access":case"web_app_request_phone":return ct("6.9",e);case"web_app_setup_settings_button":return ct("6.10",e);case"web_app_biometry_get_info":case"web_app_biometry_open_settings":case"web_app_biometry_request_access":case"web_app_biometry_request_auth":case"web_app_biometry_update_token":return ct("7.2",e);default:return["iframe_ready","iframe_will_reload","web_app_close","web_app_data_send","web_app_expand","web_app_open_link","web_app_ready","web_app_request_theme","web_app_request_viewport","web_app_setup_main_button","web_app_setup_closing_behavior"].includes(t)}}function pt(t){return"external"in t&&ot(t.external)&&"notify"in t.external&&"function"==typeof t.external.notify}function ut(t){return"TelegramWebviewProxy"in t&&ot(t.TelegramWebviewProxy)&&"postEvent"in t.TelegramWebviewProxy&&"function"==typeof t.TelegramWebviewProxy.postEvent}function lt(){try{return window.self!==window.top}catch(t){return!0}}let dt="https://web.telegram.org";function _t(t){dt=t}function gt(){return dt}function ft(t,e,s){let n,r={};if(e||s?e&&s?(r=s,n=e):e&&("targetOrigin"in e?r=e:n=e):r={},function(){y&&v.log(...arguments)}("Posting event:",n?{event:t,data:n}:{event:t}),lt())return window.parent.postMessage(JSON.stringify({eventType:t,eventData:n}),r.targetOrigin||gt());if(pt(window))window.external.notify(JSON.stringify({eventType:t,eventData:n}));else{if(!ut(window))throw T(k,"Unable to determine current environment and possible way to send event. You are probably trying to use Mini Apps method outside the Telegram application environment.");window.TelegramWebviewProxy.postEvent(t,JSON.stringify(n))}}function bt(t){return(e,s)=>{if(!ht(e,t))throw T(R,'Method "'.concat(e,'" is unsupported in Mini Apps version ').concat(t));if(ot(s)&&"web_app_set_header_color"===e&&"color"in s&&!ht(e,"color",t))throw T(I,'Parameter "color" of "'.concat(e,'" method is unsupported in Mini Apps version ').concat(t));return ft(e,s)}}function mt(t){return e=>{let{req_id:s}=e;return s===t}}function wt(t){return T(q,"Timeout reached: ".concat(t,"ms"))}function vt(t,e){return Promise.race(["function"==typeof t?t():t,new Promise((t,s)=>{setTimeout(()=>{s(wt(e))},e)})])}async function yt(t){let e;const s=new Promise(t=>e=t),{event:n,capture:r,timeout:i}=t,[,o]=C((Array.isArray(n)?n:[n]).map(t=>it(t,s=>{(!r||(Array.isArray(n)?r({event:t,payload:s}):r(s)))&&e(s)})));try{return(t.postEvent||ft)(t.method,t.params),await(i?vt(s,i):s)}finally{o()}}async function Et(t,e,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const{result:i,error:o}=await yt((0,r.A)((0,r.A)({},n),{},{method:"web_app_invoke_custom_method",event:"custom_method_invoked",params:{method:t,params:e,req_id:s},capture:mt(s)}));if(o)throw T(O,o);return i}function At(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return e.map(t=>"string"==typeof t?t:ot(t)?At(Object.entries(t).map(t=>t[1]&&t[0])):Array.isArray(t)?At(...t):void 0).filter(Boolean).join(" ")}function Pt(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return e.reduce((t,e)=>(ot(e)&&Object.entries(e).forEach(e=>{let[s,n]=e;const r=At(t[s],n);r.length&&(t[s]=r)}),t),{})}function xt(t){return/^#[\da-f]{6}$/i.test(t)}function Ct(t){return/^#[\da-f]{3}$/i.test(t)}function St(t){const e=t.replace(/\s/g,"").toLowerCase();if(xt(e))return e;if(Ct(e)){let t="#";for(let s=0;s<3;s+=1)t+=e[1+s].repeat(2);return t}const s=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/)||e.match(/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),\d{1,3}\)$/);if(!s)throw new Error('Value "'.concat(t,'" does not satisfy any of known RGB formats.'));return s.slice(1).reduce((t,e)=>{const s=parseInt(e,10).toString(16);return t+(1===s.length?"0":"")+s},"#")}function Tt(t){const e=St(t);return Math.sqrt([.299,.587,.114].reduce((t,s,n)=>{const r=parseInt(e.slice(1+2*n,1+2*(n+1)),16);return t+r*r*s},0))<120}class Rt{constructor(t){f(this,"ee",new P),f(this,"on",this.ee.on.bind(this.ee)),f(this,"off",this.ee.off.bind(this.ee)),this.state=t}clone(){return(0,r.A)({},this.state)}set(t,e){Object.entries("string"==typeof t?{[t]:e}:t).reduce((t,e)=>{let[s,n]=e;return this.state[s]===n||void 0===n?t:(this.state[s]=n,this.ee.emit("change:".concat(s),n),!0)},!1)&&this.ee.emit("change",this.state)}get(t){return this.state[t]}}class It{constructor(t){f(this,"state"),f(this,"get"),f(this,"set"),f(this,"clone"),this.state=new Rt(t),this.set=this.state.set.bind(this.state),this.get=this.state.get.bind(this.state),this.clone=this.state.clone.bind(this.state)}}function kt(t,e){return s=>ht(e[s],t)}class Ot extends It{constructor(t,e,s){super(t),f(this,"supports"),this.supports=kt(e,s)}}class qt extends Ot{constructor(t,e,s){super({isVisible:t},e,{show:"web_app_setup_back_button",hide:"web_app_setup_back_button"}),f(this,"on",(t,e)=>"click"===t?it("back_button_pressed",e):this.state.on(t,e)),f(this,"off",(t,e)=>"click"===t?rt("back_button_pressed",e):this.state.off(t,e)),this.postEvent=s}set isVisible(t){this.set("isVisible",t),this.postEvent("web_app_setup_back_button",{is_visible:t})}get isVisible(){return this.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}const Nt=G(t=>t instanceof Date?t:new Date(1e3*$().parse(t)),"Date");function Dt(t,e){return new H(e=>{if("string"!=typeof e&&!(e instanceof URLSearchParams))throw U();const s="string"==typeof e?new URLSearchParams(e):e;return z(t,t=>{const e=s.get(t);return null===e?void 0:e})},!1,e)}const Vt=K({id:$(),type:F(),title:F(),photoUrl:{type:F().optional(),from:"photo_url"},username:F().optional()},"Chat").optional(),Mt=K({addedToAttachmentMenu:{type:j().optional(),from:"added_to_attachment_menu"},allowsWriteToPm:{type:j().optional(),from:"allows_write_to_pm"},firstName:{type:F(),from:"first_name"},id:$(),isBot:{type:j().optional(),from:"is_bot"},isPremium:{type:j().optional(),from:"is_premium"},languageCode:{type:F().optional(),from:"language_code"},lastName:{type:F().optional(),from:"last_name"},photoUrl:{type:F().optional(),from:"photo_url"},username:F().optional()},"User").optional();function Lt(){return Dt({authDate:{type:Nt(),from:"auth_date"},canSendAfter:{type:$().optional(),from:"can_send_after"},chat:Vt,chatInstance:{type:F().optional(),from:"chat_instance"},chatType:{type:F().optional(),from:"chat_type"},hash:F(),queryId:{type:F().optional(),from:"query_id"},receiver:Mt,startParam:{type:F().optional(),from:"start_param"},user:Mt},"InitData")}const Bt=G(t=>St(F().parse(t)),"rgb");function Wt(t){return t.replace(/[A-Z]/g,t=>"_".concat(t.toLowerCase()))}const Ut=G(t=>{const e=Bt().optional();return Object.entries(J(t)).reduce((t,s)=>{let[n,r]=s;return t[function(t){return t.replace(/_[a-z]/g,t=>t[1].toUpperCase())}(n)]=e.parse(r),t},{})},"ThemeParams");function Ht(t){return Dt({botInline:{type:j().optional(),from:"tgWebAppBotInline"},initData:{type:Lt().optional(),from:"tgWebAppData"},initDataRaw:{type:F().optional(),from:"tgWebAppData"},platform:{type:F(),from:"tgWebAppPlatform"},showSettings:{type:j().optional(),from:"tgWebAppShowSettings"},startParam:{type:F().optional(),from:"tgWebAppStartParam"},themeParams:{type:Ut(),from:"tgWebAppThemeParams"},version:{type:F(),from:"tgWebAppVersion"}}).parse(t)}function Gt(t){return Ht(t.replace(/^[^?#]*[?#]/,"").replace(/[?#]/g,"&"))}function jt(){return Gt(window.location.href)}function zt(){return performance.getEntriesByType("navigation")[0]}function Jt(){const t=zt();if(!t)throw new Error("Unable to get first navigation entry.");return Gt(t.name)}function Kt(t){return"tma.js/".concat(t.replace(/[A-Z]/g,t=>"-".concat(t.toLowerCase())))}function $t(t,e){sessionStorage.setItem(Kt(t),JSON.stringify(e))}function Ft(t){const e=sessionStorage.getItem(Kt(t));try{return e?JSON.parse(e):void 0}catch(s){}}function Qt(){return Ht(Ft("launchParams")||"")}function Yt(t){return JSON.stringify(Object.fromEntries(Object.entries(t).map(t=>{let[e,s]=t;return[Wt(e),s]})))}function Zt(t){const{initDataRaw:e,themeParams:s,platform:n,version:r,showSettings:i,startParam:o,botInline:a}=t,c=new URLSearchParams;return c.set("tgWebAppPlatform",n),c.set("tgWebAppThemeParams",Yt(s)),c.set("tgWebAppVersion",r),e&&c.set("tgWebAppData",e),o&&c.set("tgWebAppStartParam",o),"boolean"==typeof i&&c.set("tgWebAppShowSettings",i?"1":"0"),"boolean"==typeof a&&c.set("tgWebAppBotInline",a?"1":"0"),c.toString()}function Xt(t){$t("launchParams",Zt(t))}function te(){for(const e of[jt,Jt,Qt])try{const t=e();return Xt(t),t}catch(t){}throw new Error("Unable to retrieve launch parameters from any known source.")}function ee(){const t=zt();return!(!t||"reload"!==t.type)}const[se]=b(function(){let t=0;return()=>(t+=1).toString()});function ne(t,e){return()=>{const s=te(),n=(0,r.A)((0,r.A)({},s),{},{postEvent:bt(s.version),createRequestId:se()});if("function"==typeof t)return t(n);const[i,o,a]=C(),c=e((0,r.A)((0,r.A)({},n),{},{state:ee()?Ft(t):void 0,addCleanup:i})),h=e=>(a||i(e.on("change",e=>{$t(t,e)})),e);return[c instanceof Promise?c.then(h):h(c),o]}}const re=ne("backButton",t=>{let{postEvent:e,version:s,state:n={isVisible:!1}}=t;return new qt(n.isVisible,s,e)});class ie extends Ot{constructor(){super(...arguments),f(this,"on",this.state.on.bind(this.state)),f(this,"off",this.state.off.bind(this.state))}}function oe(t){const e=t.available?t:{available:!1,device_id:"",token_saved:!1,access_requested:!1,access_granted:!1,type:""};return{available:!0,type:e.type,deviceId:e.device_id,tokenSaved:e.token_saved,accessRequested:e.access_requested,accessGranted:e.access_granted}}class ae extends ie{constructor(t){let{postEvent:e,version:s}=t;super(n(t,i),s,{auth:"web_app_biometry_request_auth",openSettings:"web_app_biometry_open_settings",requestAccess:"web_app_biometry_request_access",updateToken:"web_app_biometry_update_token"}),f(this,"postEvent"),f(this,"authPromise"),f(this,"accessPromise"),this.postEvent=e}get available(){return this.get("available")}get accessGranted(){return this.get("accessGranted")}get accessRequested(){return this.get("accessRequested")}async authenticate(t){let{reason:e}=t,s=n(t,o);return this.authPromise||(this.authPromise=yt((0,r.A)((0,r.A)({},s),{},{method:"web_app_biometry_request_auth",event:"biometry_auth_requested",postEvent:this.postEvent,params:{reason:(e||"").trim()}})).then(t=>{let{token:e}=t;return e}).finally(()=>this.authPromise=void 0)),this.authPromise}get deviceId(){return this.get("deviceId")}openSettings(){this.postEvent("web_app_biometry_open_settings")}requestAccess(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{reason:e}=t,s=n(t,a);return this.accessPromise||(this.accessPromise=yt((0,r.A)((0,r.A)({},s),{},{postEvent:this.postEvent,method:"web_app_biometry_request_access",event:"biometry_info_received",params:{reason:e||""}})).then(t=>{const e=oe(t);return this.set(e),e.accessGranted}).finally(()=>this.accessPromise=void 0)),this.accessPromise}get biometryType(){return this.get("biometryType")}get tokenSaved(){return this.get("tokenSaved")}async updateToken(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{token:e}=t,s=n(t,c);return["removed","updated"].includes((await yt((0,r.A)((0,r.A)({},s),{},{postEvent:this.postEvent,method:"web_app_biometry_update_token",event:"biometry_token_updated",params:{token:e||""}}))).status)}}async function ce(t){return oe(await yt((0,r.A)((0,r.A)({},t||{}),{},{method:"web_app_biometry_get_info",event:"biometry_info_received"})))}const he=ne("biometryManager",async t=>{let{postEvent:e,version:s,state:n}=t;return new ae((0,r.A)((0,r.A)({},n||ht("web_app_biometry_get_info",s)?n||await ce({timeout:1e3}):{available:!1,accessGranted:!1,accessRequested:!1,tokenSaved:!1,deviceId:""}),{},{version:s,postEvent:e}))});class pe extends It{constructor(){super(...arguments),f(this,"on",this.state.on.bind(this.state)),f(this,"off",this.state.off.bind(this.state))}}class ue extends pe{constructor(t,e){super({isConfirmationNeeded:t}),this.postEvent=e}set isConfirmationNeeded(t){this.set("isConfirmationNeeded",t),this.postEvent("web_app_setup_closing_behavior",{need_confirmation:t})}get isConfirmationNeeded(){return this.get("isConfirmationNeeded")}disableConfirmation(){this.isConfirmationNeeded=!1}enableConfirmation(){this.isConfirmationNeeded=!0}}const le=ne("closingBehavior",t=>{let{postEvent:e,state:s={isConfirmationNeeded:!1}}=t;return new ue(s.isConfirmationNeeded,e)});class de{constructor(t,e){f(this,"supports"),this.supports=kt(t,e)}}function _e(t){if(Array.isArray(t))return t;if("string"==typeof t)try{const e=JSON.parse(t);if(Array.isArray(e))return e}catch(e){}throw U()}class ge extends H{constructor(t,e,s){super(_e,e,s),f(this,"itemParser"),this.itemParser="function"==typeof t?t:t.parse.bind(t)}parse(t){const e=super.parse(t);return void 0===e?e:e.map(this.itemParser)}of(t){return this.itemParser="function"==typeof t?t:t.parse.bind(t),this}}function fe(t){return new ge(t=>t,!1,t)}function be(t,e){return Object.fromEntries(t.map(t=>[t,e]))}class me extends de{constructor(t,e,s){super(t,{delete:"web_app_invoke_custom_method",get:"web_app_invoke_custom_method",getKeys:"web_app_invoke_custom_method",set:"web_app_invoke_custom_method"}),this.createRequestId=e,this.postEvent=s}async delete(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Array.isArray(t)?t:[t];s.length&&await Et("deleteStorageValues",{keys:s},this.createRequestId(),(0,r.A)((0,r.A)({},e),{},{postEvent:this.postEvent}))}async getKeys(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return fe().of(F()).parse(await Et("getStorageKeys",{},this.createRequestId(),(0,r.A)((0,r.A)({},t),{},{postEvent:this.postEvent})))}async get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=Array.isArray(t)?t:[t];if(!s.length)return be(s,"");const n=await Et("getStorageValues",{keys:s},this.createRequestId(),(0,r.A)((0,r.A)({},e),{},{postEvent:this.postEvent})),i=K(be(s,F()),"CloudStorageData").parse(n);return Array.isArray(t)?i:i[t]}async set(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};await Et("saveStorageValue",{key:t,value:e},this.createRequestId(),(0,r.A)((0,r.A)({},s),{},{postEvent:this.postEvent}))}}const we=ne(t=>{let{createRequestId:e,postEvent:s,version:n}=t;return new me(n,e,s)});class ve extends de{constructor(t,e){super(t,{impactOccurred:"web_app_trigger_haptic_feedback",notificationOccurred:"web_app_trigger_haptic_feedback",selectionChanged:"web_app_trigger_haptic_feedback"}),this.postEvent=e}impactOccurred(t){this.postEvent("web_app_trigger_haptic_feedback",{type:"impact",impact_style:t})}notificationOccurred(t){this.postEvent("web_app_trigger_haptic_feedback",{type:"notification",notification_type:t})}selectionChanged(){this.postEvent("web_app_trigger_haptic_feedback",{type:"selection_change"})}}const ye=ne(t=>{let{version:e,postEvent:s}=t;return new ve(e,s)});class Ee{constructor(t){this.initData=t}get authDate(){return this.initData.authDate}get canSendAfter(){return this.initData.canSendAfter}get canSendAfterDate(){const{canSendAfter:t}=this;return t?new Date(this.authDate.getTime()+1e3*t):void 0}get chat(){return this.initData.chat}get chatType(){return this.initData.chatType}get chatInstance(){return this.initData.chatInstance}get hash(){return this.initData.hash}get queryId(){return this.initData.queryId}get receiver(){return this.initData.receiver}get startParam(){return this.initData.startParam}get user(){return this.initData.user}}const Ae=ne(t=>{let{initData:e}=t;return e?new Ee(e):void 0});function Pe(t){return Lt().parse(t)}class xe extends ie{constructor(t,e,s){super({isOpened:t},e,{open:"web_app_open_invoice"}),this.postEvent=s}set isOpened(t){this.set("isOpened",t)}get isOpened(){return this.get("isOpened")}async open(t,e){if(this.isOpened)throw new Error("Invoice is already opened");let s;if(e){const{hostname:e,pathname:n}=new URL(t,window.location.href);if("t.me"!==e)throw new Error("Incorrect hostname: ".concat(e));const r=n.match(/^\/(\$|invoice\/)([A-Za-z0-9\-_=]+)$/);if(!r)throw new Error('Link pathname has incorrect format. Expected to receive "/invoice/{slug}" or "/${slug}"');[,,s]=r}else s=t;this.isOpened=!0;try{return(await yt({method:"web_app_open_invoice",event:"invoice_closed",params:{slug:s},postEvent:this.postEvent,capture:t=>s===t.slug})).status}finally{this.isOpened=!1}}}const Ce=ne(t=>{let{version:e,postEvent:s}=t;return new xe(!1,e,s)});class Se extends It{constructor(t){let{postEvent:e}=t;super(n(t,h)),f(this,"postEvent"),f(this,"on",(t,e)=>"click"===t?it("main_button_pressed",e):this.state.on(t,e)),f(this,"off",(t,e)=>"click"===t?rt("main_button_pressed",e):this.state.off(t,e)),this.postEvent=e}get bgColor(){return this.get("bgColor")}commit(){""!==this.text&&this.postEvent("web_app_setup_main_button",{is_visible:this.isVisible,is_active:this.isEnabled,is_progress_visible:this.isLoaderVisible,text:this.text,color:this.bgColor,text_color:this.textColor})}disable(){return this.isEnabled=!1,this}enable(){return this.isEnabled=!0,this}hide(){return this.isVisible=!1,this}hideLoader(){return this.isLoaderVisible=!1,this}set isEnabled(t){this.setParams({isEnabled:t})}get isEnabled(){return this.get("isEnabled")}set isLoaderVisible(t){this.setParams({isLoaderVisible:t})}get isLoaderVisible(){return this.get("isLoaderVisible")}set isVisible(t){this.setParams({isVisible:t})}get isVisible(){return this.get("isVisible")}show(){return this.isVisible=!0,this}showLoader(){return this.isLoaderVisible=!0,this}setText(t){return this.setParams({text:t})}setTextColor(t){return this.setParams({textColor:t})}setBgColor(t){return this.setParams({bgColor:t})}setParams(t){return this.set(t),this.commit(),this}get text(){return this.get("text")}get textColor(){return this.get("textColor")}}const Te=ne("mainButton",t=>{let{postEvent:e,themeParams:s,state:n={isVisible:!1,isEnabled:!1,text:"",isLoaderVisible:!1,textColor:s.buttonTextColor||"#ffffff",bgColor:s.buttonColor||"#000000"}}=t;return new Se((0,r.A)((0,r.A)({},n),{},{postEvent:e}))});function Re(t,e){return s=>{const[n,r]=e[s];return ht(n,r,t)}}function Ie(t){return new Promise(e=>{setTimeout(e,t)})}class ke extends ie{constructor(t){let{postEvent:e,createRequestId:s,version:r,botInline:i}=t;super(n(t,p),r,{requestPhoneAccess:"web_app_request_phone",requestWriteAccess:"web_app_request_write_access",switchInlineQuery:"web_app_switch_inline_query",setHeaderColor:"web_app_set_header_color",setBackgroundColor:"web_app_set_background_color"}),f(this,"botInline"),f(this,"postEvent"),f(this,"createRequestId"),f(this,"requestPhoneAccessPromise"),f(this,"requestWriteAccessPromise"),f(this,"supportsParam"),this.createRequestId=s,this.postEvent=e,this.botInline=i;const o=this.supports.bind(this);this.supports=t=>!!o(t)&&("switchInlineQuery"!==t||i),this.supportsParam=Re(r,{"setHeaderColor.color":["web_app_set_header_color","color"]})}async getRequestedContact(){let{timeout:t=1e4}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Dt({contact:K({userId:{type:$(),from:"user_id"},phoneNumber:{type:F(),from:"phone_number"},firstName:{type:F(),from:"first_name"},lastName:{type:F().optional(),from:"last_name"}}),authDate:{type:Nt(),from:"auth_date"},hash:F()},"RequestedContact").parse(await Et("getRequestedContact",{},this.createRequestId(),{postEvent:this.postEvent,timeout:t}))}get bgColor(){return this.get("bgColor")}close(t){this.postEvent("web_app_close",{return_back:t})}get headerColor(){return this.get("headerColor")}get isBotInline(){return this.botInline}get isDark(){return Tt(this.bgColor)}ready(){this.postEvent("web_app_ready")}async requestContact(){let{timeout:t=5e3}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{return await this.getRequestedContact()}catch(n){}if("sent"!==await this.requestPhoneAccess())throw new Error("Access denied.");const e=Date.now()+t;let s=50;return vt(async()=>{for(;Date.now()<e;){try{return await this.getRequestedContact()}catch(n){}await Ie(s),s+=50}throw wt(t)},t)}async requestPhoneAccess(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.requestPhoneAccessPromise||(this.requestPhoneAccessPromise=yt((0,r.A)((0,r.A)({},t),{},{method:"web_app_request_phone",event:"phone_requested",postEvent:this.postEvent})).then(t=>{let{status:e}=t;return e}).finally(()=>this.requestPhoneAccessPromise=void 0)),this.requestPhoneAccessPromise}async requestWriteAccess(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.requestWriteAccessPromise||(this.requestWriteAccessPromise=yt((0,r.A)((0,r.A)({},t),{},{method:"web_app_request_write_access",event:"write_access_requested",postEvent:this.postEvent})).then(t=>{let{status:e}=t;return e}).finally(()=>this.requestWriteAccessPromise=void 0)),this.requestWriteAccessPromise}sendData(t){const{size:e}=new Blob([t]);if(!e||e>4096)throw new Error("Passed data has incorrect size: ".concat(e));this.postEvent("web_app_data_send",{data:t})}setHeaderColor(t){this.postEvent("web_app_set_header_color",xt(t)?{color:t}:{color_key:t}),this.set("headerColor",t)}setBgColor(t){this.postEvent("web_app_set_background_color",{color:t}),this.set("bgColor",t)}switchInlineQuery(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!this.supports("switchInlineQuery")&&!this.isBotInline)throw new Error("Method is unsupported because Mini App should be launched in inline mode.");this.postEvent("web_app_switch_inline_query",{query:t,chat_types:e})}}const Oe=ne("miniApp",t=>{let{themeParams:e,botInline:s=!1,state:i={bgColor:e.bgColor||"#ffffff",headerColor:e.headerBgColor||"#000000"}}=t,o=n(t,u);return new ke((0,r.A)((0,r.A)((0,r.A)({},o),i),{},{botInline:s}))});function qe(t){const e=t.message.trim(),s=(t.title||"").trim(),n=t.buttons||[];let i;if(s.length>64)throw new Error("Title has incorrect size: ".concat(s.length));if(!e.length||e.length>256)throw new Error("Message has incorrect size: ".concat(e.length));if(n.length>3)throw new Error("Buttons have incorrect size: ".concat(n.length));return i=n.length?n.map(t=>{const{id:e=""}=t;if(e.length>64)throw new Error("Button ID has incorrect size: ".concat(e));if(!t.type||"default"===t.type||"destructive"===t.type){const s=t.text.trim();if(!s.length||s.length>64){const e=t.type||"default";throw new Error('Button text with type "'.concat(e,'" has incorrect size: ').concat(t.text.length))}return(0,r.A)((0,r.A)({},t),{},{text:s,id:e})}return(0,r.A)((0,r.A)({},t),{},{id:e})}):[{type:"close",id:""}],{title:s,message:e,buttons:i}}class Ne extends ie{constructor(t,e,s){super({isOpened:t},e,{open:"web_app_open_popup"}),this.postEvent=s}set isOpened(t){this.set("isOpened",t)}get isOpened(){return this.get("isOpened")}async open(t){if(this.isOpened)throw new Error("Popup is already opened.");this.isOpened=!0;try{const{button_id:e=null}=await yt({event:"popup_closed",method:"web_app_open_popup",postEvent:this.postEvent,params:qe(t)});return e}finally{this.isOpened=!1}}}const De=ne(t=>{let{postEvent:e,version:s}=t;return new Ne(!1,s,e)});class Ve extends ie{constructor(t,e,s){super({isOpened:t},e,{close:"web_app_close_scan_qr_popup",open:"web_app_open_scan_qr_popup"}),this.postEvent=s}close(){this.postEvent("web_app_close_scan_qr_popup"),this.isOpened=!1}set isOpened(t){this.set("isOpened",t)}get isOpened(){return this.get("isOpened")}async open(t){if(this.isOpened)throw new Error("The scanner is already opened");const{text:e,capture:s}=("string"==typeof t?{text:t}:t)||{};this.isOpened=!0;try{const t=(await yt({method:"web_app_open_scan_qr_popup",event:["qr_text_received","scan_qr_popup_closed"],postEvent:this.postEvent,params:{text:e},capture:t=>"scan_qr_popup_closed"===t.event||!s||s(t.payload)})||{}).data||null;return t&&this.close(),t}finally{this.isOpened=!1}}}const Me=ne(t=>{let{version:e,postEvent:s}=t;return new Ve(!1,e,s)});class Le extends Ot{constructor(t,e,s){super({isVisible:t},e,{show:"web_app_setup_settings_button",hide:"web_app_setup_settings_button"}),f(this,"on",(t,e)=>"click"===t?it("settings_button_pressed",e):this.state.on(t,e)),f(this,"off",(t,e)=>"click"===t?rt("settings_button_pressed",e):this.state.off(t,e)),this.postEvent=s}set isVisible(t){this.set("isVisible",t),this.postEvent("web_app_setup_settings_button",{is_visible:t})}get isVisible(){return this.get("isVisible")}hide(){this.isVisible=!1}show(){this.isVisible=!0}}const Be=ne("settingsButton",t=>{let{version:e,postEvent:s,state:n={isVisible:!1}}=t;return new Le(n.isVisible,e,s)});function We(t){return Ut().parse(t)}class Ue extends pe{get accentTextColor(){return this.get("accentTextColor")}get bgColor(){return this.get("bgColor")}get buttonColor(){return this.get("buttonColor")}get buttonTextColor(){return this.get("buttonTextColor")}get destructiveTextColor(){return this.get("destructiveTextColor")}getState(){return this.clone()}get headerBgColor(){return this.get("headerBgColor")}get hintColor(){return this.get("hintColor")}get isDark(){return!this.bgColor||Tt(this.bgColor)}get linkColor(){return this.get("linkColor")}get secondaryBgColor(){return this.get("secondaryBgColor")}get sectionBgColor(){return this.get("sectionBgColor")}get sectionHeaderTextColor(){return this.get("sectionHeaderTextColor")}get sectionSeparatorColor(){return this.get("sectionHeaderTextColor")}listen(){return it("theme_changed",t=>{this.set(We(t.theme_params))})}get subtitleTextColor(){return this.get("subtitleTextColor")}get textColor(){return this.get("textColor")}}const He=ne("themeParams",t=>{let{themeParams:e,state:s=e,addCleanup:n}=t;const r=new Ue(s);return n(r.listen()),r});function Ge(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return yt((0,r.A)((0,r.A)({},t),{},{method:"web_app_request_theme",event:"theme_changed"})).then(We)}function je(t,e){return t.startsWith(e)?t:"".concat(e).concat(t)}function ze(t){return new URL("string"==typeof t?t:"".concat(t.pathname||"").concat(je(t.search||"","?")).concat(je(t.hash||"","#")),"http://a")}class Je extends de{constructor(t,e,s){super(t,{readTextFromClipboard:"web_app_read_text_from_clipboard"}),f(this,"supportsParam"),this.version=t,this.createRequestId=e,this.postEvent=s,this.supportsParam=Re(t,{"openLink.tryInstantView":["web_app_open_link","try_instant_view"]})}openLink(t,e){const s=ze(t).toString();if(!ht("web_app_open_link",this.version))return void window.open(s,"_blank");const n="boolean"==typeof e?{tryInstantView:e}:e||{};this.postEvent("web_app_open_link",{url:s,try_browser:n.tryBrowser,try_instant_view:n.tryInstantView})}openTelegramLink(t){const{hostname:e,pathname:s,search:n}=new URL(t,"https://t.me");if("t.me"!==e)throw new Error("URL has not allowed hostname: ".concat(e,'. Only "t.me" is allowed'));ht("web_app_open_tg_link",this.version)?this.postEvent("web_app_open_tg_link",{path_full:s+n}):window.location.href=t}async readTextFromClipboard(){const t=this.createRequestId(),{data:e=null}=await yt({method:"web_app_read_text_from_clipboard",event:"clipboard_text_received",postEvent:this.postEvent,params:{req_id:t},capture:mt(t)});return e}shareURL(t,e){this.openTelegramLink("https://t.me/share/url?"+new URLSearchParams({url:t,text:e||""}).toString().replace(/\+/g,"%20"))}}const Ke=ne(t=>{let{version:e,postEvent:s,createRequestId:n}=t;return new Je(e,n,s)});async function $e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=await yt((0,r.A)((0,r.A)({},t),{},{method:"web_app_request_viewport",event:"viewport_changed"})),{is_expanded:s,is_state_stable:i}=e,o=n(e,l);return(0,r.A)((0,r.A)({},o),{},{isExpanded:s,isStateStable:i})}function Fe(t){return t<0?0:t}class Qe extends pe{constructor(t){let{postEvent:e,stableHeight:s,height:n,width:r,isExpanded:i}=t;super({height:Fe(n),isExpanded:i,stableHeight:Fe(s),width:Fe(r)}),f(this,"postEvent"),this.postEvent=e}async sync(t){const e=await $e(t),{isStateStable:s}=e,i=n(e,d);this.set((0,r.A)((0,r.A)({},i),{},{stableHeight:s?i.height:this.get("stableHeight")}))}get height(){return this.get("height")}get stableHeight(){return this.get("stableHeight")}listen(){return it("viewport_changed",t=>{const{height:e,width:s,is_expanded:n,is_state_stable:i}=t,o=Fe(e);this.set((0,r.A)({height:o,isExpanded:n,width:Fe(s)},i?{stableHeight:o}:{}))})}get isExpanded(){return this.get("isExpanded")}get width(){return this.get("width")}expand(){this.postEvent("web_app_expand"),this.set("isExpanded",!0)}get isStable(){return this.stableHeight===this.height}}const Ye=ne("viewport",async t=>{let{state:e,platform:s,postEvent:n,addCleanup:r}=t,i=!1,o=0,a=0,c=0;if(e)i=e.isExpanded,o=e.height,a=e.width,c=e.stableHeight;else if(["macos","tdesktop","unigram","webk","weba","web"].includes(s))i=!0,o=window.innerHeight,a=window.innerWidth,c=window.innerHeight;else{const t=await $e({timeout:1e3,postEvent:n});i=t.isExpanded,o=t.height,a=t.width,c=t.isStateStable?o:0}const h=new Qe({postEvent:n,height:o,width:a,stableHeight:c,isExpanded:i});return r(h.listen()),h});function Ze(t,e){document.documentElement.style.setProperty(t,e)}function Xe(t,e,s){s||(s=t=>"--tg-".concat(t,"-color"));const n=s("header"),r=s("bg"),i=()=>{const{headerColor:s}=t;if(xt(s))Ze(n,s);else{const{bgColor:t,secondaryBgColor:r}=e;"bg_color"===s&&t?Ze(n,t):"secondary_bg_color"===s&&r&&Ze(n,r)}Ze(r,t.bgColor)},o=[e.on("change",i),t.on("change",i)];return i(),()=>o.forEach(t=>t())}function ts(t,e){e||(e=t=>"--tg-theme-".concat(t.replace(/[A-Z]/g,t=>"-".concat(t.toLowerCase()))));const s=()=>{Object.entries(t.getState()).forEach(t=>{let[s,n]=t;n&&Ze(e(s),n)})};return s(),t.on("change",s)}function es(t,e){e||(e=t=>"--tg-viewport-".concat(t));const[s,n,r]=["height","width","stable-height"].map(t=>e(t)),i=()=>Ze(s,"".concat(t.height,"px")),o=()=>Ze(n,"".concat(t.width,"px")),a=()=>Ze(r,"".concat(t.stableHeight,"px")),c=[t.on("change:height",i),t.on("change:width",o),t.on("change:stableHeight",a)];return i(),o(),a(),()=>c.forEach(t=>t())}function ss(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=[it("reload_iframe",()=>{ft("iframe_will_reload"),window.location.reload()})];if(t){const t=document.createElement("style");t.id="telegram-custom-styles",document.head.appendChild(t),e.push(it("set_custom_style",e=>{t.innerHTML=e}),()=>document.head.removeChild(t))}return ft("iframe_ready",{reload_supported:!0}),()=>e.forEach(t=>t())}function ns(){return typeof window>"u"}async function rs(){if(ut(window))return!0;try{return await yt({method:"web_app_request_theme",event:"theme_changed",timeout:100}),!0}catch(t){return!1}}function is(t){const e="string"==typeof t?Ht(t):t;function s(t){if("string"==typeof t)try{const{eventType:s}=Q(t);"web_app_request_theme"===s&&Z("theme_changed",{theme_params:JSON.parse(Yt(e.themeParams))}),"web_app_request_viewport"===s&&Z("viewport_changed",{width:window.innerWidth,height:window.innerHeight,is_state_stable:!0,is_expanded:!0})}catch(s){}}if(Xt(e),lt()){const t=window.parent.postMessage.bind(window.parent);return void(window.parent.postMessage=e=>{s(e),t(e)})}if(pt(window)){const t=window.external.notify.bind(window.external);return void(window.external.notify=e=>{s(e),t(e)})}const n=window.TelegramWebviewProxy;window.TelegramWebviewProxy=(0,r.A)((0,r.A)({},n||{}),{},{postEvent(){s(JSON.stringify({eventType:arguments.length<=0?void 0:arguments[0],eventData:arguments.length<=1?void 0:arguments[1]})),n&&n.postEvent(...arguments)}})}function os(t){return t instanceof S}function as(t,e){return os(t)&&t.type===e}function cs(t,e){let s,n,r;return"string"==typeof t?s=t:(s=void 0===t.pathname?e:t.pathname,n=t.params,r=t.id),Object.freeze({id:r||(16384*Math.random()|0).toString(16),pathname:s,params:n})}class hs{constructor(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ft;if(f(this,"history"),f(this,"ee",new P),f(this,"attached",!1),f(this,"back",()=>this.go(-1)),f(this,"on",this.ee.on.bind(this.ee)),f(this,"off",this.ee.off.bind(this.ee)),this._index=e,this.postEvent=s,0===t.length)throw T(V,"History should not be empty.");if(e<0||e>=t.length)throw T(M,"Index should not be zero and higher or equal than history size.");this.history=t.map(t=>cs(t,""))}attach(){this.attached||(this.attached=!0,this.sync(),it("back_button_pressed",this.back))}get current(){return this.history[this.index]}detach(){this.attached=!1,rt("back_button_pressed",this.back)}forward(){this.go(1)}go(t,e){const s=this.index+t,n=Math.min(Math.max(0,s),this.history.length-1);(s===n||e)&&this.replaceAndMove(n,this.history[n])}goTo(t,e){this.go(t-this.index,e)}get hasPrev(){return this.index>0}get hasNext(){return this.index!==this.history.length-1}get index(){return this._index}push(t){this.hasNext&&this.history.splice(this.index+1),this.replaceAndMove(this.index+1,cs(t,this.current.pathname))}replace(t){this.replaceAndMove(this.index,cs(t,this.current.pathname))}replaceAndMove(t,e){const s=t-this.index;if(!s&&this.current===e)return;const n=this.current;if(this.index!==t){const e=this._index;this._index=t,this.attached&&e>0!=t>0&&this.sync()}this.history[t]=e,this.ee.emit("change",{navigator:this,from:n,to:this.current,delta:s})}sync(){this.postEvent("web_app_setup_back_button",{is_visible:!!this.index})}}function ps(t){let{params:e}=t,s=n(t,_);return(0,r.A)((0,r.A)({},e||{hash:"",search:""}),s)}function us(t){const e="string"==typeof t?t.startsWith("/"):!(!t.pathname||!t.pathname.startsWith("/")),s=ze(t);return"".concat(e?s.pathname:s.pathname.slice(1)).concat(s.search).concat(s.hash)}function ls(t,e,s){let n,r;"string"==typeof t?n=t:(n=us(t),s=t.state,r=t.id);const{pathname:i,search:o,hash:a}=new URL(n,"http://a".concat(je(e,"/")));return{id:r,pathname:i,params:{hash:a,search:o,state:s}}}async function ds(t){return 0===t||Promise.race([new Promise(e=>{const s=x("popstate",()=>{s(),e(!0)});window.history.go(t)}),new Promise(t=>{setTimeout(t,50,!1)})])}function _s(t){return ze(t).pathname}class gs{constructor(t,e){let{postEvent:s,hashMode:n="classic",base:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};f(this,"navigator"),f(this,"ee",new P),f(this,"hashMode"),f(this,"base"),f(this,"attached",!1),f(this,"onPopState",t=>{let{state:e}=t;if(null===e)return this.push(this.parsePath(window.location.href));0===e?window.history.forward():1===e&&this.back(),2===e&&this.forward()}),f(this,"onNavigatorChange",async t=>{let{to:e,from:s,delta:n}=t;this.attached&&await this.syncHistory(),this.ee.emit("change",{delta:n,from:ps(s),to:ps(e),navigator:this})}),f(this,"on",this.ee.on.bind(this.ee)),f(this,"off",this.ee.off.bind(this.ee)),this.navigator=new hs(t.map(t=>ls(t,"/")),e,s),this.navigator.on("change",t=>{this.onNavigatorChange(t)}),this.hashMode=n,this.base=_s(r||"")}async attach(){this.attached||(this.attached=!0,this.navigator.attach(),window.addEventListener("popstate",this.onPopState),await this.syncHistory())}back(){this.navigator.back()}detach(){this.attached=!1,this.navigator.detach(),window.removeEventListener("popstate",this.onPopState)}forward(){return this.navigator.forward()}get index(){return this.navigator.index}get id(){return this.navigator.current.id}go(t,e){return this.navigator.go(t,e)}goTo(t,e){this.navigator.goTo(t,e)}get hash(){return(this.navigator.current.params||{}).hash||""}get hasPrev(){return this.navigator.hasPrev}get hasNext(){return this.navigator.hasNext}get history(){return this.navigator.history.map(ps)}get path(){return us(this)}get pathname(){return this.navigator.current.pathname}parsePath(t){let e=ze(t);return this.hashMode&&(e=ze(e.hash.slice(1))),{pathname:e.pathname,search:e.search,hash:e.hash}}push(t,e){const s=ls(t,this.path),{state:n=e}=s.params;this.navigator.push((0,r.A)((0,r.A)({},s),{},{params:(0,r.A)((0,r.A)({},s.params),{},{state:n})}))}replace(t,e){const s=ls(t,this.path),{state:n=e}=s.params;this.navigator.replace((0,r.A)((0,r.A)({},s),{},{params:(0,r.A)((0,r.A)({},s.params),{},{state:n})}))}renderPath(t){const e=(1===this.base.length?"":this.base)+je(us(t),"/");return this.hashMode?je(e.slice(1),"classic"===this.hashMode?"#":"#/"):e}async syncHistory(){window.removeEventListener("popstate",this.onPopState);const{state:t}=this,e=this.renderPath(this);await async function(){if(window.history.length<=1||(window.history.pushState(null,""),await ds(1-window.history.length)))return;let t=await ds(-1);for(;t;)t=await ds(-1)}(),this.hasPrev&&this.hasNext?(window.history.replaceState(1,""),window.history.pushState(t,"",e),window.history.pushState(2,""),await ds(-1)):this.hasPrev?(window.history.replaceState(1,""),window.history.pushState(t,"",e)):this.hasNext?(window.history.replaceState(t,e),window.history.pushState(2,""),await ds(-1)):(window.history.replaceState(0,""),window.history.pushState(t,"",e)),window.addEventListener("popstate",this.onPopState)}get search(){return(this.navigator.current.params||{}).search||""}get state(){return(this.navigator.current.params||{}).state}}function fs(t){t||(t={});const{href:e,hash:s}=window.location;let n=us(null===t.hashMode?e:s.includes("?")?s.slice(1):"?".concat(s.slice(1)));const r=t.base?_s(t.base):void 0;if(r){if(!n.startsWith(r))throw T(W,'Path "'.concat(n,'" expected to be starting with "').concat(r,'"'));n=n.slice(r.length)}return new gs([n],0,t)}function bs(t){const e=t.match(/#(.+)/);return e?e[1]:null}function ms(t,e){const s=function(t,e){if(ee()){const s=sessionStorage.getItem(t);if(s)try{const{index:t,history:n}=JSON.parse(s);return new gs(n,t,e)}catch(n){console.error("Unable to restore hash navigator state.",n)}}return fs(e)}(t,e),n=()=>sessionStorage.setItem(t,JSON.stringify({index:s.index,history:s.history}));return s.on("change",n),n(),s}}}]);
//# sourceMappingURL=330.bdeeca8d.chunk.js.map