{"ast":null,"code":"let telegramSDK=null;let initData=null;let miniApp=null;function parseUser(user){var _ref,_user$firstName,_ref2,_user$lastName,_user$username,_ref3,_user$isBot,_ref4,_user$isPremium;if(!user)return null;const id=user.id;const firstName=(_ref=(_user$firstName=user.firstName)!==null&&_user$firstName!==void 0?_user$firstName:user.first_name)!==null&&_ref!==void 0?_ref:'';const lastName=(_ref2=(_user$lastName=user.lastName)!==null&&_user$lastName!==void 0?_user$lastName:user.last_name)!==null&&_ref2!==void 0?_ref2:'';const username=(_user$username=user.username)!==null&&_user$username!==void 0?_user$username:'';return{id,firstName,lastName,username,languageCode:user.languageCode||user.language_code||'ru',isBot:(_ref3=(_user$isBot=user.isBot)!==null&&_user$isBot!==void 0?_user$isBot:user.is_bot)!==null&&_ref3!==void 0?_ref3:false,isPremium:(_ref4=(_user$isPremium=user.isPremium)!==null&&_user$isPremium!==void 0?_user$isPremium:user.is_premium)!==null&&_ref4!==void 0?_ref4:false};}export async function initTelegramSDK(){try{const sdk=await import('@tma.js/sdk');telegramSDK=sdk;const miniAppResult=await sdk.initMiniApp();miniApp=miniAppResult;const initDataResult=await sdk.initInitData();initData=initDataResult;return{initData:initDataResult,miniApp:miniAppResult};}catch(error){console.error('Telegram SDK initialization error:',error);return null;}}export function getTelegramUser(){var _window$Telegram,_window$Telegram$WebA,_window$Telegram$WebA2;let user=null;if(initData&&typeof initData.user!=='undefined'){user=initData.user;}if(!user&&telegramSDK&&typeof telegramSDK.retrieveLaunchParams==='function'){try{var _params$initData;const params=telegramSDK.retrieveLaunchParams();user=(_params$initData=params.initData)===null||_params$initData===void 0?void 0:_params$initData.user;}catch(_){}}if(!user&&typeof window!=='undefined'&&(_window$Telegram=window.Telegram)!==null&&_window$Telegram!==void 0&&(_window$Telegram$WebA=_window$Telegram.WebApp)!==null&&_window$Telegram$WebA!==void 0&&(_window$Telegram$WebA2=_window$Telegram$WebA.initDataUnsafe)!==null&&_window$Telegram$WebA2!==void 0&&_window$Telegram$WebA2.user){user=window.Telegram.WebApp.initDataUnsafe.user;}return parseUser(user);}export function getInitData(){return initData;}export function getMiniApp(){return miniApp;}","map":{"version":3,"names":["telegramSDK","initData","miniApp","parseUser","user","_ref","_user$firstName","_ref2","_user$lastName","_user$username","_ref3","_user$isBot","_ref4","_user$isPremium","id","firstName","first_name","lastName","last_name","username","languageCode","language_code","isBot","is_bot","isPremium","is_premium","initTelegramSDK","sdk","miniAppResult","initMiniApp","initDataResult","initInitData","error","console","getTelegramUser","_window$Telegram","_window$Telegram$WebA","_window$Telegram$WebA2","retrieveLaunchParams","_params$initData","params","_","window","Telegram","WebApp","initDataUnsafe","getInitData","getMiniApp"],"sources":["/Users/nikitamozaev/Desktop/beznet_miniapp/front/src/services/telegram.js"],"sourcesContent":["let telegramSDK = null;\nlet initData = null;\nlet miniApp = null;\n\nfunction parseUser(user) {\n  if (!user) return null;\n  const id = user.id;\n  const firstName = user.firstName ?? user.first_name ?? '';\n  const lastName = user.lastName ?? user.last_name ?? '';\n  const username = user.username ?? '';\n  return {\n    id,\n    firstName,\n    lastName,\n    username,\n    languageCode: user.languageCode || user.language_code || 'ru',\n    isBot: user.isBot ?? user.is_bot ?? false,\n    isPremium: user.isPremium ?? user.is_premium ?? false,\n  };\n}\n\nexport async function initTelegramSDK() {\n  try {\n    const sdk = await import('@tma.js/sdk');\n    telegramSDK = sdk;\n    const miniAppResult = await sdk.initMiniApp();\n    miniApp = miniAppResult;\n    const initDataResult = await sdk.initInitData();\n    initData = initDataResult;\n    return { initData: initDataResult, miniApp: miniAppResult };\n  } catch (error) {\n    console.error('Telegram SDK initialization error:', error);\n    return null;\n  }\n}\n\nexport function getTelegramUser() {\n  let user = null;\n  if (initData && typeof initData.user !== 'undefined') {\n    user = initData.user;\n  }\n  if (!user && telegramSDK && typeof telegramSDK.retrieveLaunchParams === 'function') {\n    try {\n      const params = telegramSDK.retrieveLaunchParams();\n      user = params.initData?.user;\n    } catch (_) {}\n  }\n  if (!user && typeof window !== 'undefined' && window.Telegram?.WebApp?.initDataUnsafe?.user) {\n    user = window.Telegram.WebApp.initDataUnsafe.user;\n  }\n  return parseUser(user);\n}\n\nexport function getInitData() {\n  return initData;\n}\n\nexport function getMiniApp() {\n  return miniApp;\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}